function Matrix4(){this.data=[];for(var a=0;16>a;a++)this.data[a]=0}Matrix4.prototype.setIdentity=function(){this.data[0]=1;this.data[5]=1;this.data[10]=1;this.data[15]=1};Matrix4.prototype.add=function(a){if(a instanceof Matrix4)for(var b=0;16>b;b++)this.data[b]+=a.data[b]};Matrix4.prototype.subtract=function(a){a instanceof Matrix4&&this.add(a.negate())};Matrix4.prototype.multiplyScalar=function(a){for(var b=0;16>b;b++)this.data[b]*=a};Matrix4.prototype.negate=function(){this.multiply(-1)};
Matrix4.prototype.multiplyVector=function(a){if(a instanceof Vector4)return new Vector4(this.data[0]*a.x+this.data[1]*a.y+this.data[2]*a.z+this.data[3]*a.w,this.data[4]*a.x+this.data[5]*a.y+this.data[6]*a.z+this.data[7]*a.w,this.data[8]*a.x+this.data[9]*a.y+this.data[10]*a.z+this.data[11]*a.w,this.data[12]*a.x+this.data[13]*a.y+this.data[14]*a.z+this.data[15]*a.w)};
Matrix4.prototype.multiplyMatrix=function(a){if(a instanceof Matrix4){for(var b=new Matrix4,c=0;4>c;c++)for(var d=0;4>d;d++){for(var e=0,f=0;4>f;f++)e+=this.data[c+4*f]*a.data[f+4*d];b.data[c+4*d]=e}return b}};Matrix4.prototype.transpose=function(){for(var a=new Matrix4,b=0;4>b;b++)for(var c=0;4>c;c++)a.data[c+4*b]=this.data[b+4*c];return a};
Matrix4.rotate=function(a,b,c,d){var e=new Matrix4;e.setIdentity();var f=Math.cos(a);a=Math.sin(a);var g=1-f;e.data[0]=b*g+f;e.data[4]=c*b*g+d*a;e.data[8]=b*d*g-c*a;e.data[1]=b*c*g-d*a;e.data[5]=c*g+f;e.data[9]=c*d*g+b*a;e.data[2]=b*d*g+c*a;e.data[6]=c*d*g-b*a;e.data[10]=d*g+f;return e};
Matrix4.translate=function(a){var b=new Matrix4;b.setIdentity();a instanceof Vector2?(b.data[12]=a.x,b.data[13]=a.y):a instanceof Vector3?(b.data[12]=a.x,b.data[13]=a.y,b.data[14]=a.z):a instanceof Vector4&&(b.data[12]=a.x,b.data[13]=a.y,b.data[14]=a.z,b.data[15]=a.w);return b};
Matrix4.scale=function(a){var b=new Matrix4;b.setIdentity();if(a instanceof Vector2)return b.data[0]=a.x,b.data[5]=a.y,b;if(a instanceof Vector3)return b.data[0]=a.x,b.data[5]=a.y,b.data[10]=a.z,b;if(a instanceof Vector4)return b.data[0]=a.x,b.data[5]=a.y,b.data[10]=a.z,b.data[15]=a.w,b};function Matrix3(){this.data=[];for(var a=0;9>a;a++)this.data[a]=0}Matrix3.prototype.setIdentity=function(){this.data[0]=1;this.data[4]=1;this.data[8]=1};
Matrix3.prototype.add=function(a){if(a instanceof Matrix3)for(var b=0;9>b;b++)this.data[b]+=a.data[b]};Matrix3.prototype.subtract=function(a){a instanceof Matrix3&&this.add(a.negate())};Matrix3.prototype.multiplyScalar=function(a){for(var b=0;9>b;b++)this.data[b]*=a};Matrix3.prototype.negate=function(){this.multiply(-1)};
Matrix3.prototype.multiplyVector=function(a){if(a instanceof Vector3)return new Vector3(this.data[0]*a.x+this.data[1]*a.y+this.data[2]*a.z,this.data[3]*a.x+this.data[4]*a.y+this.data[5]*a.z,this.data[6]*a.x+this.data[7]*a.y+this.data[8]*a.z)};Matrix3.prototype.multiplyMatrix=function(a){if(a instanceof Matrix3){for(var b=new Matrix3,c=0;3>c;c++)for(var d=0;3>d;d++){for(var e=0,f=0;3>f;f++)e+=this.data[c+3*f]*a.data[f+3*d];b.data[c+3*d]=e}return b}};
Matrix3.prototype.transpose=function(){for(var a=new Matrix3,b=0;3>b;b++)for(var c=0;3>c;c++)a.data[c+3*b]=this.data[b+3*c];return a};Matrix3.translate=function(a){var b=new Matrix3;b.setIdentity();a instanceof Vector2?(b.data[6]=a.x,b.data[7]=a.y):a instanceof Vector3&&(b.data[6]=a.x,b.data[7]=a.y,b.data[8]=a.z);return b};
Matrix3.rotate=function(a,b,c,d){var e=new Matrix3;e.setIdentity();var f=Math.cos(a);a=Math.sin(a);var g=1-f;e.data[0]=b*g+f;e.data[3]=c*b*g+d*a;e.data[6]=b*d*g-c*a;e.data[1]=b*c*g-d*a;e.data[4]=c*g+f;e.data[7]=c*d*g+b*a;e.data[2]=b*d*g+c*a;e.data[5]=c*d*g-b*a;e.data[8]=d*g+f;return e};Matrix3.scale=function(a){var b=new Matrix3;b.setIdentity();if(a instanceof Vector3)return b.data[0]=a.x,b.data[4]=a.y,b.data[8]=a.z,b;if(a instanceof Vector2)return b.data[0]=a.x,b.data[4]=a.y,b};
function Matrix2(){this.data=[];for(var a=0;4>a;a++)this.data[a]=0}Matrix2.prototype.setIdentity=function(){this.data[0]=1;this.data[3]=1};Matrix2.prototype.add=function(a){if(a instanceof Matrix2)for(var b=0;4>b;b++)this.data[b]+=a.data[b]};Matrix2.prototype.subtract=function(a){a instanceof Matrix2&&this.add(a.negate())};Matrix2.prototype.multiplyScalar=function(a){for(var b=0;4>b;b++)this.data[b]*=a};Matrix2.prototype.negate=function(){this.multiply(-1)};
Matrix2.prototype.multiplyVector=function(a){if(a instanceof Vector2)return new Vector2(this.data[0]*a.x+this.data[1]*a.y,this.data[2]*a.x+this.data[3]*a.y,z)};Matrix2.prototype.multiplyMatrix=function(a){if(a instanceof Matrix2){for(var b=new Matrix2,c=0;2>c;c++)for(var d=0;2>d;d++){for(var e=0,f=0;2>f;f++)e+=this.data[c+2*f]*a.data[f+2*d];b.data[c+2*d]=e}return b}};Matrix2.prototype.transpose=function(){for(var a=new Matrix2,b=0;2>b;b++)for(var c=0;2>c;c++)a.data[c+2*b]=this.data[b+2*c];return a};
Matrix2.translate=function(a){var b=new Matrix2;b.setIdentity();a instanceof Vector2&&(b.data[2]=a.x,b.data[3]=a.y);return b};Matrix2.rotate=function(a){var b=new Matrix2;b.setIdentity();var c=Math.cos(a);a=Math.sin(a);b.data[0]=c;b.data[2]=-a;b.data[1]=a;b.data[3]=c;return b};Matrix2.scale=function(a){var b=new Matrix2;if(a instanceof Vector2)return b.data[0]=a.x,b.data[3]=a.y,b};function Vector4(a,b,c,d){this.x=a;this.y=b;this.z=c;this.w=d}
Vector4.prototype.mag=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z,this.w*this.w)};Vector4.prototype.distance=function(a){if(a instanceof Vector4)return Math.sqrt((this.x-a.x)*(this.x-a.x)+(this.y-a.y)*(this.y-a.y)+(this.z-a.z)*(this.z-a.z)+(this.w-a.w)*(this.w-a.w))};Vector4.prototype.add=function(a){a instanceof Vector4&&(this.x+=a.x,this.y+=a.y,this.z+=a.z,this.w+=a.w);return this};Vector4.prototype.subtract=function(a){a instanceof Vector4&&this.add(a.negate);return this};
Vector4.prototype.negate=function(){this.multiply(-1);return this};Vector4.prototype.multiply=function(a){this.x*=a;this.y*=a;this.z*=a;this.w*=a;return this};Vector4.prototype.divide=function(a){0!=a&&this.multiply(1/a);return this};Vector4.prototype.normalize=function(){this.divide(this.mag());return this};Vector4.dot=function(a,b){if(a instanceof Vector4&&b instanceof Vector4)return a.x*b.x+a.y*b.y+a.z*b.z+a.w*b.w};function Vector3(a,b,c){this.x=a;this.y=b;this.z=c}
Vector3.prototype.mag=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)};Vector3.prototype.distance=function(a){if(a instanceof Vector3)return Math.sqrt((this.x-a.x)*(this.x-a.x)+(this.y-a.y)*(this.y-a.y)+(this.z-a.z)*(this.z-a.z))};Vector3.prototype.add=function(a){a instanceof Vector3&&(this.x+=a.x,this.y+=a.y,this.z+=a.z);return this};Vector3.prototype.subtract=function(a){a instanceof Vector3&&this.add(a.negate);return this};
Vector3.prototype.negate=function(){this.multiply(-1);return this};Vector3.prototype.multiply=function(a){this.x*=a;this.y*=a;this.z*=a;return this};Vector3.prototype.divide=function(a){0!=a&&this.multiply(1/a);return this};Vector3.prototype.normalize=function(){this.divide(this.mag());return this};Vector3.cross=function(a,b){if(a instanceof Vector3&&b instanceof Vector3)return new Vector3(a.y*b.z-a.z*b.y,a.z*b.x-a.x*b.z,a.x*b.y-a.y*b.x)};
Vector3.dot=function(a,b){if(a instanceof Vector3&&b instanceof Vector3)return a.x*b.x+a.y*b.y+a.z*b.z};function Vector2(a,b){this.x=a;this.y=b}Vector2.prototype.mag=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};Vector2.prototype.distance=function(a){if(a instanceof Vector2)return Math.sqrt((this.x-a.x)*(this.x-a.x)+(this.y-a.y)*(this.y-a.y))};Vector2.prototype.add=function(a){a instanceof Vector2&&(this.x+=a.x,this.y+=a.y);return this};
Vector2.prototype.subtract=function(a){a instanceof Vector2&&this.add(a.negate);return this};Vector2.prototype.negate=function(){this.multiply(-1);return this};Vector2.prototype.multiply=function(a){this.x*=a;this.y*=a;return this};Vector2.prototype.divide=function(a){0!=a&&this.multiply(1/a);return this};Vector2.prototype.normalize=function(){this.divide(this.mag());return this};Vector2.dot=function(a,b){if(a instanceof Vector2&&b instanceof Vector2)return a.x*b.x+a.y*b.y};